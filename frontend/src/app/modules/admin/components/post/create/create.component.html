<div class="row">
    <div class="col-xxl-12">
        <div class="card">
            <div class="card-header align-items-center d-flex">
                <h4 class="card-title mb-0 flex-grow-1">Tạo bài viết</h4>
            </div>

            <div class="card-body">
                <form [formGroup]="postForm" (ngSubmit)="savePost()">
                    <!-- Người dùng -->
                    <div class="form-group mb-3">
                        <label
                            >Người đăng bài
                            <span class="text-danger">*</span></label
                        >
                        <input
                            type="text"
                            class="form-control"
                            [value]="currentUser.username"
                            readonly
                        />
                    </div>

                    <!-- Danh mục -->
                    <div class="form-group mb-3">
                        <label
                            >Danh mục <span class="text-danger">*</span></label
                        >
                        <select
                            formControlName="category_id"
                            class="form-control"
                            [ngClass]="{
                                'is-invalid':
                                    submitted && f['category_id'].errors
                            }"
                        >
                            <option value="">-- Chọn danh mục --</option>
                            <option
                                *ngFor="let c of categoryList"
                                [value]="c.id"
                            >
                                {{ c.name }}
                            </option>
                        </select>
                        <div
                            *ngIf="submitted && f['category_id'].errors"
                            class="invalid-feedback d-block"
                        >
                            <div *ngIf="f['category_id'].errors['required']">
                                Vui lòng chọn danh mục
                            </div>
                        </div>
                    </div>

                    <!-- Ngôn ngữ -->
                    <div class="form-group mb-3">
                        <label
                            >Ngôn ngữ <span class="text-danger">*</span></label
                        >
                        <select
                            formControlName="language_id"
                            class="form-control"
                            [ngClass]="{
                                'is-invalid':
                                    submitted && f['language_id'].errors
                            }"
                        >
                            <option value="">-- Chọn ngôn ngữ --</option>
                            <option
                                *ngFor="let l of languageList"
                                [value]="l.id"
                            >
                                {{ l.name }}
                            </option>
                        </select>
                        <div
                            *ngIf="submitted && f['language_id'].errors"
                            class="invalid-feedback d-block"
                        >
                            <div *ngIf="f['language_id'].errors['required']">
                                Vui lòng chọn ngôn ngữ
                            </div>
                        </div>
                    </div>

                    <!-- Tiêu đề -->
                    <div class="form-group mb-3">
                        <label
                            >Tiêu đề <span class="text-danger">*</span></label
                        >
                        <input
                            type="text"
                            formControlName="title"
                            class="form-control"
                            [ngClass]="{
                                'is-invalid': submitted && f['title'].errors
                            }"
                            placeholder="Nhập tiêu đề bài viết"
                        />
                        <div
                            *ngIf="submitted && f['title'].errors"
                            class="invalid-feedback"
                        >
                            <div *ngIf="f['title'].errors['required']">
                                Vui lòng nhập tiêu đề
                            </div>
                        </div>
                    </div>

                    <!-- Mô tả -->
                    <div class="form-group mb-3">
                        <label>Mô tả <span class="text-danger">*</span></label>
                        <textarea
                            formControlName="description"
                            class="form-control"
                            [ngClass]="{
                                'is-invalid':
                                    submitted && f['description'].errors
                            }"
                            placeholder="Nhập mô tả"
                        ></textarea>
                        <div
                            *ngIf="submitted && f['description'].errors"
                            class="invalid-feedback"
                        >
                            <div *ngIf="f['description'].errors['required']">
                                Vui lòng nhập mô tả
                            </div>
                        </div>
                    </div>

                    <!-- Nội dung -->
                    <div class="form-group mb-3">
                        <label
                            >Nội dung <span class="text-danger">*</span></label
                        >
                        <ngx-editor-menu
                            [editor]="editor"
                            [toolbar]="toolbar"
                        ></ngx-editor-menu>
                        <ngx-editor
                            [editor]="editor"
                            formControlName="content"
                            class="form-control"
                        ></ngx-editor>
                        <div
                            *ngIf="submitted && f['content'].errors"
                            class="invalid-feedback d-block"
                        >
                            <div *ngIf="f['content'].errors['required']">
                                Vui lòng nhập nội dung
                            </div>
                        </div>
                    </div>

                    <!-- Trạng thái -->
                    <div class="form-group mb-3">
                        <label>Trạng thái</label>
                        <select formControlName="status" class="form-control">
                            <option [value]="1">Hoạt động</option>
                            <option [value]="0">Không hoạt động</option>
                        </select>
                    </div>
 <!-- Avatar -->
<div class="form-group mb-3">
  <label>Ảnh đại diện (Avatar)</label>

  <!-- Upload file -->
  <input
    type="file"
    class="form-control mb-2"
    (change)="onFileChange($event)"
    accept="image/*"
  />
<!-- Dán link ảnh -->
<input
  type="text"
  class="form-control mb-2"
  placeholder="Hoặc dán link ảnh..."
  [(ngModel)]="imageUrl"
  [ngModelOptions]="{ standalone: true }"
  (input)="onImageUrlChange()"
  name="avatarUrlInput"
/>


  <!-- Xem trước ảnh -->
  <div *ngIf="previewImage" class="mt-2">
    <label class="form-label">Xem trước ảnh:</label>
    <img
      [src]="previewImage"
      alt="Avatar preview"
      class="img-thumbnail"
      style="max-width: 200px;"
    />
  </div>

 </div>



                    <!-- Nút Lưu -->
                    <div class="form-group text-end">
                        <button type="submit" class="btn btn-primary">
                            Lưu bài viết
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
